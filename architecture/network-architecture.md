# Network Architecture – Dual Network Suricata IDS Lab

## Overview

This lab implements a dual-network Suricata IDS architecture to simulate real-world traffic inspection between an attacker and a target system.

The architecture forces all traffic generated by the attacker (Kali Linux) to traverse the Suricata inspection node before reaching the victim (Ubuntu running DVWA).

This design ensures:

- Full traffic visibility
- Inline packet inspection
- Signature-based detection validation
- Structured alert generation
- Controlled and repeatable attack simulation

---

## Architecture Diagram

![Dual Network Suricata IDS Architecture](../evidence/screenshots/00_Architecture/01_suricata_ids_dual_network_architecture.png)

The diagram illustrates:

- SOC-IN network (Attacker side)
- SOC-OUT network (Target side)
- Suricata positioned as the inspection bridge
- Controlled traffic flow path

---

## Lab Components

### 1. Kali Linux (Attacker)

Role:
- Generates reconnaissance scans (Nmap)
- Performs ICMP reachability tests
- Launches SQL Injection and XSS payloads
- Sends HTTP traffic toward DVWA

Purpose:
To simulate adversarial behavior in a controlled lab environment.

---

### 2. Suricata IDS (Inspection Node)

Role:
- Dual network interfaces:
  - Ingress (SOC-IN)
  - Egress (SOC-OUT)
- Inspects all passing traffic
- Applies:
  - ET Open rule set
  - Custom local rules
- Logs alerts to:
  - `/var/log/suricata/fast.log`
  - `/var/log/suricata/eve.json`

Purpose:
To act as an inline inspection engine and detection validation point.

---

### 3. Ubuntu Server (DVWA Target)

Role:
- Hosts Damn Vulnerable Web Application (DVWA)
- Receives attacker traffic only through Suricata
- Provides exploitable web interface for SQLi and XSS testing

Purpose:
Controlled victim system for validating detection logic.

---

## Network Segmentation Design

The lab uses two isolated internal networks to prevent direct attacker-to-victim communication.

### SOC-IN (Ingress Network)
- Contains Kali
- Connects to Suricata’s ingress interface
- All attacker traffic enters Suricata from this network

### SOC-OUT (Egress Network)
- Contains Ubuntu DVWA server
- Connected to Suricata’s egress interface
- Suricata forwards inspected traffic here

This segmentation ensures Suricata remains the mandatory inspection chokepoint.

---

## Traffic Flow

High-Level Flow:

Kali (Attacker)
        ↓
Suricata (Inspection & Forwarding)
        ↓
Ubuntu (DVWA Target)

---

### Step-by-Step Packet Flow

1. Kali generates traffic (ping, Nmap, HTTP exploit).
2. Packet enters Suricata via SOC-IN interface.
3. Suricata inspects:
   - Layer 3/4 headers (IP, TCP, ports)
   - Layer 7 payload (HTTP content, injection strings)
4. Rules are evaluated:
   - ET Open signatures
   - Custom rules
5. If rule match occurs:
   - Alert written to fast.log
   - Structured JSON event written to eve.json
6. Packet is forwarded via SOC-OUT interface.
7. Ubuntu receives traffic.

This guarantees that no traffic reaches DVWA without inspection.

---

## Inline Routing and IP Forwarding

Suricata is configured with IP forwarding enabled.

This allows it to function as a routing bridge between:

- SOC-IN
- SOC-OUT

This is critical because:

- Suricata is not passively sniffing mirrored traffic
- It actively sits in the forwarding path
- Detection reflects real transit traffic

This simulates a real inline IDS deployment model.

---

## Detection Workflow

1. Attack initiated from Kali.
2. Traffic captured by Suricata.
3. Rule engine evaluates packet.
4. Matching signatures trigger alerts.
5. Logs validated via:
   - packet-analysis.md
   - alert-analysis.md

---

## Logging Architecture

### fast.log
- Quick alert confirmation
- Human-readable
- Used for screenshot validation

### eve.json
- Structured JSON output
- Contains:
  - Timestamp
  - Source IP
  - Destination IP
  - Signature ID
  - Category
  - Severity
  - Payload metadata (when applicable)

This format reflects SOC pipeline logging practices.

---

## Security Design Rationale

This architecture was intentionally chosen to:

- Enforce inspection visibility
- Simulate segmented enterprise networks
- Validate rule loading and trigger behavior
- Provide repeatable detection scenarios
- Demonstrate understanding of inline IDS placement

---

## Skills Demonstrated

- Network segmentation
- Inline IDS deployment
- Traffic routing and forwarding
- Packet inspection concepts
- Signature-based detection
- Alert validation and log analysis
- Structured security documentation

---

## Conclusion

The dual-network Suricata architecture provides a controlled, realistic environment for testing detection logic and validating alert generation against reconnaissance and web exploitation activity.

All malicious activity is:

- Inspected
- Logged
- Validated
- Documented

This architecture mirrors practical SOC-level IDS deployment and investigation workflow.
